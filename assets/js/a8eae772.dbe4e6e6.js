"use strict";(self.webpackChunkgo_zero=self.webpackChunkgo_zero||[]).push([[7928],{3905:function(e,t,o){o.d(t,{Zo:function(){return c},kt:function(){return m}});var a=o(7294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,a,n=function(e,t){if(null==e)return{};var o,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var s=a.createContext({}),u=function(e){var t=a.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var o=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(o),m=n,g=p["".concat(s,".").concat(m)]||p[m]||d[m]||r;return o?a.createElement(g,i(i({ref:t},c),{},{components:o})):a.createElement(g,i({ref:t},c))}));function m(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=o.length,i=new Array(r);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var u=2;u<r;u++)i[u]=o[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,o)}p.displayName="MDXCreateElement"},2378:function(e,t,o){o.r(t),o.d(t,{default:function(){return d},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return u}});var a=o(7462),n=o(3366),r=(o(7294),o(3905)),i=["components"],l={title:"Develop a travel system using go-zero go-zero-looklook",authors:"Mikaelemmmm"},s={unversionedId:"blog/showcase/go-zero-looklook",id:"blog/showcase/go-zero-looklook",isDocsHomePage:!1,title:"Develop a travel system using go-zero go-zero-looklook",description:"Using go-zero to develop a travel system go-zero-looklook",source:"@site/docs/blog/showcase/go-zero-looklook.md",sourceDirName:"blog/showcase",slug:"/blog/showcase/go-zero-looklook",permalink:"/docs/blog/showcase/go-zero-looklook",editUrl:"https://github.com/zeromicro/portal/edit/main/docs/blog/showcase/go-zero-looklook.md",version:"current",lastUpdatedAt:1655654232,formattedLastUpdatedAt:"6/19/2022",frontMatter:{title:"Develop a travel system using go-zero go-zero-looklook",authors:"Mikaelemmmm"},sidebar:"blog",previous:{title:"Queue",permalink:"/docs/blog/showcase/go-queue"},next:{title:"Microservice metrics monitoring based on prometheus",permalink:"/docs/blog/showcase/metric"}},u=[{value:"Project address",id:"project-address",children:[]},{value:"Project documentation",id:"project-documentation",children:[]},{value:"Project Introduction",id:"project-introduction",children:[]},{value:"System architecture diagram",id:"system-architecture-diagram",children:[]},{value:"Business architecture diagram",id:"business-architecture-diagram",children:[]},{value:"Gateway",id:"gateway",children:[]},{value:"development model",id:"development-model",children:[]},{value:"Logging",id:"logging",children:[]},{value:"Monitoring",id:"monitoring",children:[]},{value:"link tracking",id:"link-tracking",children:[]},{value:"Message queue",id:"message-queue",children:[]},{value:"Delayed queues, timed tasks",id:"delayed-queues-timed-tasks",children:[]},{value:"Distributed Transactions",id:"distributed-transactions",children:[]},{value:"Deployment",id:"deployment",children:[]}],c={toc:u};function d(e){var t=e.components,l=(0,n.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h4",{id:"using-go-zero-to-develop-a-travel-system-go-zero-looklook"},"Using go-zero to develop a travel system go-zero-looklook"),(0,r.kt)("p",null,"The go-zero author is very enthusiastic and patient to help me answer a lot of questions, I also want to actively help go-zero to promote the community. -zero to promote the community, basically in the community group to answer questions related to everyone, because in this process found that many people feel go-zero does not have a complete project example, as a member of the community want to promote, so I will be internal project to delete some key things, on the engage a available version of open source out, the main technology stack contains the following."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"go-zero"),(0,r.kt)("li",{parentName:"ul"},"nginx gateway"),(0,r.kt)("li",{parentName:"ul"},"filebeat"),(0,r.kt)("li",{parentName:"ul"},"kafka"),(0,r.kt)("li",{parentName:"ul"},"go-stash"),(0,r.kt)("li",{parentName:"ul"},"elasticsearch"),(0,r.kt)("li",{parentName:"ul"},"kibana"),(0,r.kt)("li",{parentName:"ul"},"prometheus"),(0,r.kt)("li",{parentName:"ul"},"grafana"),(0,r.kt)("li",{parentName:"ul"},"jaeger"),(0,r.kt)("li",{parentName:"ul"},"go-queue"),(0,r.kt)("li",{parentName:"ul"},"asynq"),(0,r.kt)("li",{parentName:"ul"},"asynqmon"),(0,r.kt)("li",{parentName:"ul"},"docker"),(0,r.kt)("li",{parentName:"ul"},"docker"),(0,r.kt)("li",{parentName:"ul"},"docker-compose"),(0,r.kt)("li",{parentName:"ul"},"mysql"),(0,r.kt)("li",{parentName:"ul"},"redis")),(0,r.kt)("h2",{id:"project-address"},"Project address"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/Mikaelemmmm/go-zero-looklook"},"https://github.com/Mikaelemmmm/go-zero-looklook")),(0,r.kt)("h2",{id:"project-documentation"},"Project documentation"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/Mikaelemmmm/go-zero-looklook/tree/main/doc"},"https://github.com/Mikaelemmmm/go-zero-looklook/tree/main/doc")),(0,r.kt)("h2",{id:"project-introduction"},"Project Introduction"),(0,r.kt)("p",null,"The whole project uses go-zero development of microservices, basically contains go-zero and related go-zero author development of some middleware, the technology stack used is basically go-zero project team of self-research components, basically go-zero family bucket\nIn addition, the front-end is a small program, the project has been docked to the small program authorization login and WeChat payment, front-end to see if the open source it later"),(0,r.kt)("p",null,"The project directory structure is as follows."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"app: all business code including api, rpc and mq (message queue, delay queue, timing tasks)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"common: common components error, middleware, interceptor, tool, ctxdata , etc.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"data: This project contains the data generated by the directory dependency on all middleware (mysql, es, redis, grafana, etc.), all the content in this directory should be in the git ignore file, no need to commit.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"deploy."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"filebeat: docker deployment filebeat configuration"),(0,r.kt)("li",{parentName:"ul"},"go-stash: go-stash configuration"),(0,r.kt)("li",{parentName:"ul"},"nginx: nginx gateway configuration"),(0,r.kt)("li",{parentName:"ul"},"prometheus : prometheus configuration"),(0,r.kt)("li",{parentName:"ul"},"script.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"gencode: generate api, rpc, and create kafka statements, copy and paste to use"),(0,r.kt)("li",{parentName:"ul"},"mysql: sh tool for generating mods"))),(0,r.kt)("li",{parentName:"ul"},"goctl: the project goctl template, goctl generate custom code templates, tempalte usage can refer to go-zero documentation, copy to the home directory .\nThe project uses goctl version is v1.2.3"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"doc : the project series documentation"))),(0,r.kt)("h2",{id:"system-architecture-diagram"},"System architecture diagram"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"jiagou",src:o(2226).Z})),(0,r.kt)("h2",{id:"business-architecture-diagram"},"Business architecture diagram"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"jiagou",src:o(2598).Z})),(0,r.kt)("h2",{id:"gateway"},"Gateway"),(0,r.kt)("p",null,"nginx do gateway, use nginx auth module, call the back-end identity service unified authentication, business internal authentication is not, if it involves more business funds can also be in the business of secondary authentication, in order to security well."),(0,r.kt)("p",null,"In addition, many students feel that nginx is not a good gateway, the principle of this piece is basically the same, you can replace it with apisix, kong, etc."),(0,r.kt)("h2",{id:"development-model"},"development model"),(0,r.kt)("p",null,"The project uses microservice development, api (http) + rpc (grpc), api act as an aggregation service, complex, involving other business calls written in the rpc, if some simple business will not be used by other service dependencies, you can write directly in the api's logic"),(0,r.kt)("h2",{id:"logging"},"Logging"),(0,r.kt)("p",null,"About the log, unified use filebeat collection, reported to kafka, because logstash know all understand, resource consumption is too exaggerated, here used go-stash to replace the logstash"),(0,r.kt)("p",null,"Link: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kevwan/go-stash"},"https://github.com/kevwan/go-stash")," , go-stash is developed by the go-zero development team, high performance does not take up resources, the main amount of code is not much, you only need to configure it can be used, very simple. It is bar kafka data source synchronization to elasticsearch, the default does not support elasticsearch account password, I forked a copy of the modified, very simple to support the account, password"),(0,r.kt)("h2",{id:"monitoring"},"Monitoring"),(0,r.kt)("p",null,"monitoring using prometheus, this go-zero native support, just need to configure it, here you can see the configuration of the project"),(0,r.kt)("h2",{id:"link-tracking"},"link tracking"),(0,r.kt)("p",null,"go-zero default jaeger, zipkin support, just need to configure it, you can see the configuration"),(0,r.kt)("h2",{id:"message-queue"},"Message queue"),(0,r.kt)("p",null,"message queue using go-zero development team developed by go-queue, link: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/zeromicro/go-queue"},"https://github.com/zeromicro/go-queue")),(0,r.kt)("p",null,"Here you can use kq, kq is based on kafka to do high-performance message queue"),(0,r.kt)("p",null,"generic go-queue also has dq, is a delayed queue, but the current project does not use dq"),(0,r.kt)("h2",{id:"delayed-queues-timed-tasks"},"Delayed queues, timed tasks"),(0,r.kt)("p",null,"delayed queue, timing tasks this project is using asynq, google team to give redis development of simple middleware."),(0,r.kt)("p",null,"Of course, asynq also supports message queues, you can also replace the kq message queue into this, after all, only need redis does not need to maintain a kafka is also good"),(0,r.kt)("p",null,"Link: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/hibiken/asynq"},"https://github.com/hibiken/asynq")),(0,r.kt)("h2",{id:"distributed-transactions"},"Distributed Transactions"),(0,r.kt)("p",null,'distributed transactions ready to use is dtm, well , very comfortable, before I wrote a "go-zero docking distributed transactions dtm nanny tutorial" Link: ',(0,r.kt)("a",{parentName:"p",href:"https://github.com/Mikaelemmmm/gozerodtm"},"https://github.com/Mikaelemmmm/gozerodtm")," , the project is not currently used to, the follow-up is ready to integrate directly on the good, if readers use directly to Look at that source code on the line"),(0,r.kt)("h2",{id:"deployment"},"Deployment"),(0,r.kt)("p",null,"Deployment, the current direct use of docker can deploy the entire technology stack, if the k8s words, the simplest direct use of Ali cloud it"),(0,r.kt)("p",null,"I say the next idea, this follow-up will come out of an Ali cloud effect based on the deployment to k8s documentation tutorials, build a gitlab, jenkins, harbor to do if too time-consuming"),(0,r.kt)("p",null,"1, the code will be placed in the Ali cloud effect (of course you whole to gitlab is also OK)"),(0,r.kt)("p",null,"2, in the Ali cloud effect to create a pipeline, basically a service a pipeline"),(0,r.kt)("p",null,"3, pipeline steps :)"),(0,r.kt)("p",null,"pull code ---\x3e ci detection (here you can omit ha, do it yourself) ---\x3e build the image (go-zero official Dockerfile and tutorials, don't tell me won't) ---\x3e push to Ali cloud mirror service ---\x3e use kubectl to Ali cloud k8s pull mirror (ack, ask can, ask can not use daemonset can not be used. ask can't use daemonset can't use filebeat) ----\x3eok"),(0,r.kt)("p",null,"In addition, if you want to do it yourself based on gitlab, jenkins, harbor, then, well, find your own operations and maintenance to get it, I have written a tutorial before, free in the whole bar old brothers!"))}d.isMDXComponent=!0},2226:function(e,t,o){t.Z=o.p+"assets/images/gozerolooklook-37f925e0f6098f59ade6c0101d680e28.png"},2598:function(e,t,o){t.Z=o.p+"assets/images/looklook-service-88a15d6736c32e417b328331154ce1f9.jpg"}}]);